(()=>{"use strict";class t{constructor(){this.canvas=document.querySelector(".canvas"),this.containers=document.querySelectorAll(".container"),this.character=document.querySelector(".character"),this.cruceta=document.querySelector(".cruceta"),this.imgElements=Array.from(this.containers).flatMap((t=>Array.from(t.children)));const t=this.canvas.clientWidth,e=(this.canvas.scrollWidth-t)/2;this.canvas.scrollLeft=e;const i=t/2*1.2;this.targetX=i,this.transitionSpeed=2,this.isTrue=!1,this.sprites=[{nombre:"iddle",index:[0,13]},{nombre:"d",index:[14,31]},{nombre:"a",index:[31,14]},{nombre:"jBallF",index:[32,47]},{nombre:"jBallB",index:[47,32]},{nombre:"background",index:[0,5]}],this.A=0,this.B=13,this.key="iddle",this.time=0,this.setupEventListeners(),this.gameLoop()}gameLoop(){requestAnimationFrame(this.gameLoop.bind(this)),this.getRender()}setupEventListeners(){document.getElementById("right").addEventListener("touchstart",(()=>this.handleTouchStart("d"))),document.getElementById("left").addEventListener("touchstart",(()=>this.handleTouchStart("a"))),document.getElementById("right").addEventListener("touchend",(()=>this.handleTouchEnd())),document.getElementById("left").addEventListener("touchend",(()=>this.handleTouchEnd())),document.addEventListener("keydown",(t=>this.handleKeyDown(t))),document.addEventListener("keyup",(()=>this.handleKeyUp()))}handleTouchStart(t){this.sprite=this.sprites.find((e=>e.nombre===t)),this.A=this.sprite.index[0],this.B=this.sprite.index[1]}handleTouchEnd(){this.sprite=this.sprites[0],this.A=this.sprite.index[0],this.B=this.sprite.index[1]}handleKeyDown(t){this.isTrue||(this.isTrue=!0,this.sprite=this.sprites.find((e=>e.nombre===t.key)),this.key=t.key,this.A=this.sprite.index[0],this.B=this.sprite.index[1])}handleKeyUp(){this.isTrue=!1,this.key="iddle",this.sprite=this.sprites[0],this.A=this.sprite.index[0],this.B=this.sprite.index[1]}getRender(){this.time++,4===this.time&&(this.A+=this.A<this.B?1:-1,this.updateActiveImages(),this.handleSpriteMovement(),this.handleCanvasScroll(),this.time=0)}updateActiveImages(){this.A===this.B&&(this.A=this.sprites.find((t=>t.nombre===this.key)).index[0]);const t=this.A%2==0?this.A+1:this.A-1;for(let e=0;e<this.imgElements.length;e++){const i=e===this.A||e===t;this.imgElements[e].classList.toggle("active",i)}}handleSpriteMovement(){const t=this.sprites.indexOf(this.sprite);1===t?this.targetX+=7:2===t&&(this.targetX-=7),this.character.style.transform=`translateX(${this.targetX}px)`,this.character.style.transition=`transform ${this.transitionSpeed/20}s ease-in-out`}handleCanvasScroll(){const t=this.A<this.B?this.character.getBoundingClientRect().right:this.character.getBoundingClientRect().left,e=this.A<this.B?50:-50,i=this.canvas.clientWidth;this.shouldScroll(t,i)&&this.canvas.scrollBy({left:e,behavior:"smooth"})}isCharacterNearRightEdge(){return this.targetX<1050&&this.character.getBoundingClientRect().right<this.canvas.clientWidth}isCharacterNearLeftEdge(){return this.targetX>50&&this.character.getBoundingClientRect().left<0}shouldScroll(t,e){return t>e||t<0}}document.addEventListener("DOMContentLoaded",(function(){this.game=new t}))})();
